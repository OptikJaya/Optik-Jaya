<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optik Jaya</title>
    <link rel="stylesheet" href="styles.css">
    <base target="_top">
    <link rel="manifest" href="manifest.json">
    <script src="https://kit.fontawesome.com/7c51dff027.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
     <!-- Login Form -->
     <div id="login-container" class="form-container">
        <img src="https://raw.githubusercontent.com/OptikJaya/Optik-Jaya/refs/heads/main/1.png" alt="Logo" class="logo">
        <h2>Login to Optik Jaya</h2>
        <form id="login-form">
            <div class="form-group">
                <label for="username">Nama Pengguna:</label>
                <input type="text" id="username" required>
            </div>
            <div class="form-group">
                <label for="password" >Kata sandi:</label>
                <input type="password" id="password" required>
                <input type="checkbox" id="togglePassword" class="lihat-sandi"> Lihat Sandi
            </div>
            
            <input type="submit" value="Login">
        </form>
    </div>
   
    <div id="menu-container" class="form-container" style="display: none;">
        <h2>MENU</h2>
        <div class="menu-container">
            <button id="fill-form-btn" class="menu-btn-square">
                <img src="https://raw.githubusercontent.com/OptikJM/icon/refs/heads/main/Asset%201fill.svg" alt="Isi Formulir" class="menu-icon">
                Isi Formulir
            </button>
            <button id="show-data-btn" class="menu-btn-square">
                <img src="https://raw.githubusercontent.com/OptikJM/icon/refs/heads/main/Asset%202laporan.svg" alt="Tampilkan Data" class="menu-icon">
                Tampilkan Data
            </button>
            <button id="monthly-report-btn" class="menu-btn-square">
                <img src="https://raw.githubusercontent.com/OptikJM/icon/refs/heads/main/Asset%203laporan.svg" alt="Laporan Bulananku" class="menu-icon">
                Bulananku
            </button>
            <button id="all-sales-report-btn" class="menu-btn-square">
                <img src="https://raw.githubusercontent.com/OptikJM/icon/main/Asset%204laporan.svg" alt="Laporan Semua Sales" class="menu-icon">
                Laporan Sales
            </button>
        </div>
    </div>
    

    <div id="monthly-report-container" class="form-container" style="display: none;">
        <button id="back-to-menu-from-report-btn" class="back-btn">
            <i class="fa-solid fa-circle-chevron-left fa-2x"></i> Kembali
        </button>
        <h2>Laporan Bulananku</h2>
        <div style="display: flex; gap: 10px;">
            <label for="select-month-monthly">Bulan:</label>
            <select id="select-month-monthly" class="dropdown-style">
                <option value="">Pilih Bulan</option>
                <option value="1">Januari</option>
                <option value="2">Februari</option>
                <option value="3">Maret</option>
                <option value="4">April</option>
                <option value="5">Mei</option>
                <option value="6">Juni</option>
                <option value="7">Juli</option>
                <option value="8">Agustus</option>
                <option value="9">September</option>
                <option value="10">Oktober</option>
                <option value="11">November</option>
                <option value="12">Desember</option>
            </select>
            <label for="select-year-monthly">Tahun:</label>
            <select id="select-year-monthly" class="dropdown-style">
                <option value="">Pilih Tahun</option>
            </select>
            <button onclick="loadReportByMonth()"class="search-btn-style">
                <i class="fas fa-search"></i> Cari
            </button>
        </div>

        <table >
            <thead>
                <tr>
                    <th>Nomor</th>
                    <th>Nama</th>
                    <th>Alamat</th>
                    <th>Transaksi</th>
                    <th>Kacamata</th>
                    <th>Uang</th>
                </tr>
            </thead>
            <tbody id="report-table-body">
            <tfoot>
                <tr>
                    <td> </td>
                    <td> </td> 
                    <td> </td>
                    <td><strong>Total</strong></td> <!-- "Total" pada kolom Tanggal Transaksi -->
                    <td id="total-kacamata">0</td> <!-- Jumlah Kacamata -->
                    <td id="total-omset">Rp0</td> <!-- Total Omset -->
                </tr>
            </tfoot>
        </table>
    </div>

    <div id="semua-sales-container" class="form-container" style="display: none;">
        <button id="back-to-menu-from-semua-sales-btn" class="back-btn">
            <i class="fa-solid fa-circle-chevron-left fa-2x"></i> Kembali
        </button>
        <h2>Detail Laporan Bulanan</h2>

        <div style="display: flex; gap: 10px;">
            <label for="select-month-allsales">Bulan:</label>
            <select id="select-month-allsales" class="dropdown-style">
                <option value="">Pilih Bulan</option>
                <option value="1">Januari</option>
                <option value="2">Februari</option>
                <option value="3">Maret</option>
                <option value="4">April</option>
                <option value="5">Mei</option>
                <option value="6">Juni</option>
                <option value="7">Juli</option>
                <option value="8">Agustus</option>
                <option value="9">September</option>
                <option value="10">Oktober</option>
                <option value="11">November</option>
                <option value="12">Desember</option>
            </select>

            <label for="select-year-allsales">Tahun:</label>
            <select id="select-year-allsales" class="dropdown-style">
                <option value="">Tahun</option>
            </select>
            <button onclick="loadAllSalesMonthlyReport()"class="search-btn-style">
                <i class="fas fa-search"></i> Cari
            </button>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Nomor</th>
                    <th>Nama</th>
                    <th>Transaksi</th>
                    <th>Kacamata</th>
                    <th>Uang</th>
                </tr>
            </thead>
            <tbody id="semua-sales-table-body">
            <tfoot>
                <tr>
                    <td> </td>
                    <td> </td>
                    <td><strong>Total</strong></td> <!-- "Total" pada kolom Tanggal Transaksi -->
                    <td id="total-kacamata-semua">0</td> <!-- Jumlah Kacamata -->
                    <td id="total-omset-semua">Rp0</td> <!-- Total Omset -->
                </tr>
            </tfoot>
        </table>
    </div>

    <div id="data-view-container" class="form-container view-data-container" style="display: none;">
        <button id="back-to-data-btn" class="back-btn">
            <i class="fa-solid fa-circle-chevron-left fa-2x"></i>kembali
        </button> 
        <h2>Data Pasien</h2>
        
        <input type="text" id="search-view-input" placeholder="Cari data..." oninput="searchDataInView()"  class="search-view-style">
        <div id="action-buttons" style="display: none; margin-top: 10px;">
            <button id="edit-button" class="action-button" onclick="editRow()">Edit</button>
            <button id="detail-button" class="action-button" onclick="viewDetails()">Detail</button>
        </div>
         
        
        <div class="table-container" id="table-container">
            <!-- The table will be inserted here dynamically -->
        </div>
    </div>

    <div id="payment-summary-container" class="form-container" style="display: none;">
        <button id="back-to-menu-from-summary-btn" class="back-btn">
            <i class="fa-solid fa-circle-chevron-left fa-2x"></i> Kembali
        </button>
        <h2>Rincian Pembayaran Pelanggan</h2>
        <!-- Informasi Pelanggan -->
        <div class="form-group">
            <label id="label-rincian" class="label-rincian">Nama:</label>
            <span id="summary-nama" class="summary-rincian"></span>
        </div>
        <div class="form-group">
            <label id="label-rincian" class="label-rincian">Alamat:</label>
            <span id="summary-alamat" class="summary-rincian"></span>
        </div>
        <div class="form-group">
            <label id="label-rincian" class="label-rincian">HP:</label>
            <span id="summary-hp" class="summary-rincian"></span>
        </div>
    
        <!-- Tabel Pembayaran -->
        <table>
            <thead>
                <tr>
                    <th>Des</th>
                    <th>Tanggal</th>
                    <th>Jumlah</th>
                </tr>
            </thead>
            <tbody>
                <!-- DP Row -->
                <tr>
                    <td>DP</td>
                    <td id="summary-tanggal-dp">Pengiriman</td>
                    <td id="summary-bayar-dp">DP</td>
                </tr>
                <!-- Payment Rows -->
                <tr>
                    <td>1</td>
                    <td id="summary-tanggal-1">Bayar 1</td>
                    <td id="summary-bayar-1">Bayar 1 (IDR)</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td id="summary-tanggal-2">Bayar 2</td>
                    <td id="summary-bayar-2">Bayar 2 (IDR)</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td id="summary-tanggal-3">Bayar 3</td>
                    <td id="summary-bayar-3">Bayar 3 (IDR)</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td id="summary-tanggal-4">Bayar 4</td>
                    <td id="summary-bayar-4">Bayar 4 (IDR)</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td id="summary-tanggal-5">Bayar 5</td>
                    <td id="summary-bayar-5">Bayar 5 (IDR)</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td id="summary-tanggal-6">Bayar 6</td>
                    <td id="summary-bayar-6">Bayar 6 (IDR)</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td id="summary-tanggal-7">Bayar 7</td>
                    <td id="summary-bayar-7">Bayar 7 (IDR)</td>
                </tr>
                <!-- Total Kekurangan Row -->
                <tr>
                    <td>8</td>
                    <td>Total Kekurangan</td>
                    <td id="summary-sisa-cicilan">Sisa Cicilan</td>
                </tr>
            </tbody>
        </table>
    </div>  
    
    <div id="form-container" class="form-container" style="display: none;">
        <button id="back-to-menu-btn" class="back-btn">
            <i class="fa-solid fa-circle-chevron-left fa-2x"></i>kembali
        </button>
        <!-- User Info Section in the Top Right -->
        <div id="user-info-container" style="position: absolute; top: 20px; right: 20px;">
            <button id="user-info-btn" style="background-color: #10EFC3; color: #000000; font-weight: bold; border: none; border-radius: 8px; padding: 10px 15px; cursor: pointer;">
                <!-- Username will be inserted here dynamically -->
            </button>
            <div id="user-dropdown" style="display: none; background-color: white; border: 1px solid #ccc; padding: 10px; position: absolute; top: 40px; right: 0px; border-radius: 8px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);">
                <button id="logout-btn" style="background-color: #F24B4B; color: white; border: none; border-radius: 8px; padding: 8px 15px; cursor: pointer;">Logout</button>
            </div>
        </div>
        
    
        <!-- Logo -->
        <img src="https://raw.githubusercontent.com/OptikJaya/Optik-Jaya/refs/heads/main/1.png" alt="Logo" class="logo">  <!-- Add your logo URL here -->
        <h2>Data Pasien</h2>

        <form id="form" action="https://script.google.com/macros/s/AKfycbzkirki7_2rU4NfrzxauVSz9UTCOgCU0uGRWFvudWNQ6LqNwVJFeTd3N2GBogw072H8/exec" method="POST" onsubmit="submitForm(event)">

            <!-- Collapsible Section 1 - Data Diri Pelanggan -->
            <button type="button" class="collapsible">Data Diri Pelanggan</button>
            <div class="content">
                <div class="form-group">
                    <label for="name">Nama</label>
                    <input type="text" id="name" name="Nama" required>
                </div>

                <div class="form-group">
                    <label for="address">Alamat</label>
                    <input type="text" id="address" name="Alamat" required>
                </div>

                <div class="form-group">
                    <label for="age">Umur</label>
                    <input type="text" id="age" name="Umur" required>
                </div>

                <div class="form-group">
                    <label for="phone">HP</label>
                    <input type="tel" id="phone" name="HP" pattern="08[0-9]{8,11}" placeholder="081325465984" title="Masukkan nomor sesuai contoh" required>
                </div>

                <div class="field">
                    <label class="label">Status Pelanggan</label>
                    <div class="radio-stok" style="display: flex; flex-direction: row;">
                      <label class="radio">
                        <input type="radio" name="Status Pelanggan" value="Umum" /> Umum
                      </label>
                      <label class="radio">
                        <input type="radio" name="Status Pelanggan" value="BPJS" /> BPJS
                      </label>
                    </div>
                  </div>

                <div class="form-group">
                    <label for="coordinates">Koordinat Maps</label>
                    <input type="text" id="coordinates" name="Koordinat" placeholder="cth. -6.200000, 106.816666" >
                </div>
            </div>

            <!-- Collapsible Section 2 - Detail Pemesanan -->
            <button type="button" class="collapsible">Detail Pemesanan</button>
            <div class="content">
                <!-- Lensa field with multiple checkboxes -->
                <div class="form-group">
                    <label for="lensa">Lensa:</label>
                    <div class="radio-group" style="display: flex; flex-direction: column;">
                        <label><input type="radio" name="lensa" value="Single - WhiteMC"> Single - WhiteMC</label><br>
                        <label><input type="radio" name="lensa" value="Single - CRMC"> Single - CRMC</label><br>
                        <label><input type="radio" name="lensa" value="Single - Photochromic"> Single - Photochromic</label><br>
                        <label><input type="radio" name="lensa" value="Single - Bluechromic"> Single - Bluechromic</label><br>
                        <label><input type="radio" name="lensa" value="Single - Night Drive"> Single - Night Drive</label><br>
                        <label><input type="radio" name="lensa" value="Single - Blu-ray"> Single - Blu-ray</label><br>
                        <label><input type="radio" name="lensa" value="Kriptok - WhiteMC"> Kriptok - WhiteMC</label><br>
                        <label><input type="radio" name="lensa" value="Kriptok - CRMC"> Kriptok - CRMC</label><br>
                        <label><input type="radio" name="lensa" value="Kriptok - Photochromic"> Kriptok - Photochromic</label><br>
                        <label><input type="radio" name="lensa" value="Kriptok - Bluechromic"> Kriptok - Bluechromic</label><br>
                        <label><input type="radio" name="lensa" value="Progressive - CRMC"> Progressive - CRMC</label><br>
                        <label><input type="radio" name="lensa" value="Progressive - Photochromic"> Progressive - Photochromic</label><br>
                        <label><input type="radio" name="lensa" value="Progressive - Bluechromic"> Progressive - Bluechromic</label><br>
                        <label><input type="radio" name="lensa" value="Progressive - Night Drive"> Progressive - Night Drive</label><br>
                        <label><input type="radio" name="lensa" value="Progressive - Blu-ray"> Progressive - Blu-ray</label><br>
                        <label>
                            <input type="radio" name="lensa" value="Other" id="lensa-other" onclick="toggleOtherInput()"> Other
                        </label><br>
                        <input type="text" id="lensa-other-text" name="lensa_other_text" placeholder="Isi sendiri" style="display: none; margin-top: 5px;">
                    </div>
                </div>

                <!-- Frame field -->
                <div class="form-group">
                    <label for="frame">Frame</label>
                    <input type="text" id="frame" name="frame" required>
                </div>

                <!-- Harga Awal -->
                <div class="form-group">
                    <label for="harga-awal">Harga Awal (Dalam Ribuan) </label>
                    <input type="number" id="harga-awal" name="harga awal" required oninput="calculateHargaAkhir()">
                </div>

                <!-- Harga TT/Potongan -->
                <div class="form-group">
                    <label for="harga-tt">Harga TT/Potongan (Dalam Ribuan) </label>
                    <input type="number" id="harga-tt" name="harga tt" placeholder="jika tidak ada tulis 0" required oninput="calculateHargaAkhir()">
                </div>

                <!-- Harga Akhir -->
                <div class="form-group">
                    <label for="harga-akhir">Harga Akhir (Dalam Ribuan) </label>
                    <input type="number" id="harga-akhir" name="harga akhir" required readonly>
                </div>

                <div class="form-group">
                    <label>Stok Lensa</label>
                    <div class="radio-stok" style="display: flex; flex-direction: row;">
                       <label><input type="radio" name="stok lensa" value="ada" required> Ada</label>
                       <label><input type="radio" name="stok lensa" value="habis"> Habis</label>
                    </div>
                </div>
                
            </div>

            <!-- Collapsible Section 3 - Status Refraksi -->
            <button type="button" class="collapsible">Status Refraksi</button>
            <div class="content">
                <table class="refraksi-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>SPH</th>
                            <th>CYL</th>
                            <th>AXIS</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>R</td>
                            <td><input type="text" id="sph-kanan" name="sph kanan" placeholder="SPH Kanan"></td>
                            <td><input type="text" id="cyl-kanan" name="cyl kanan" placeholder="CYL Kanan"></td>
                            <td><input type="text" id="axis-kanan" name="axis kanan" placeholder="AXIS Kanan"></td>
                        </tr>
                        <tr>
                            <td>L</td>
                            <td><input type="text" id="sph-kiri" name="sph kiri" placeholder="SPH Kiri"></td>
                            <td><input type="text" id="cyl-kiri" name="cyl kiri" placeholder="CYL Kiri"></td>
                            <td><input type="text" id="axis-kiri" name="axis kiri" placeholder="AXIS Kiri"></td>
                        </tr>
                        <tr>
                            <td>ADD</td>
                            <td><input type="text" id="sph-add" name="sph add" placeholder="SPH ADD"></td>
                            <td><input type="text" id="cyl-add" name="cyl add" placeholder="CYL ADD"></td>
                            <td><input type="text" id="axis-add" name="axis add" placeholder="AXIS ADD"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Collapsible Section 4 - Kirim & Tagih -->
            <button type="button" class="collapsible">Kirim & Tagih</button>
            <div class="content">
                <!-- DP field -->
                <div class="form-group">
                    <label for="dp">DP (Dalam Ribuan)</label>
                    <input type="number" id="dp" name="DP" placeholder="Masukkan DP" step="any">
                </div>

                <!-- Tanggal Penagihan and Bayar fields -->
                <div class="form-group">
                    <label for="Pengiriman">Pengiriman</label>
                    <input type="date" id="pengiriman" name="Pengiriman" required>

                    <label for="tanggal-1">Tanggal Pembayaran 1</label>
                    <input type="date" id="tanggal-1" name="tanggal-bayar-1" required>

                    <label for="bayar-1">Pembayaran 1 </label> <!-- Currency Field -->
                    <input type="number" id="bayar-1" name="bayar-1" placeholder="(Dalam Ribuan)" step="any" min="0">

                    <label for="tanggal-2">Tanggal Pembayaran 2</label>
                    <input type="date" id="tanggal-2" name="tanggal-bayar-2">
                    
                    <label for="bayar-2">Pembayaran 2 </label> <!-- Currency Field -->
                    <input type="number" id="bayar-2" name="bayar-2" placeholder="(Dalam Ribuan)" step="any" min="0">

                    <label for="tanggal-3">Tanggal Pembayaran 3</label>
                    <input type="date" id="tanggal-3" name="tanggal-bayar-3">

                    <label for="bayar-3">Pembayaran 3 </label> <!-- Currency Field -->
                    <input type="number" id="bayar-3" name="bayar-3" placeholder="(Dalam Ribuan)" step="any" min="0">

                    <label for="tanggal-4">Tanggal Pembayaran 4</label>
                    <input type="date" id="tanggal-4" name="tanggal-bayar-4">
                    
                    <label for="bayar-4">Pembayaran 4 </label> <!-- Currency Field -->
                    <input type="number" id="bayar-4" name="bayar-4" placeholder="(Dalam Ribuan)" step="any" min="0">

                    <label for="tanggal-5">Tanggal Pembayaran 5</label>
                    <input type="date" id="tanggal-5" name="tanggal-bayar-5">
                    
                    <label for="bayar-5">Pembayaran 5 </label> <!-- Currency Field -->
                    <input type="number" id="bayar-5" name="bayar-5" placeholder="(Dalam Ribuan)" step="any" min="0">

                    <label for="tanggal-6">Tanggal Pembayaran 6</label>
                    <input type="date" id="tanggal-6" name="tanggal-bayar-6">
                    
                    <label for="bayar-6">Pembayaran 6 </label> <!-- Currency Field -->
                    <input type="number" id="bayar-6" name="bayar-6" placeholder="(Dalam Ribuan)" step="any" min="0">

                    <label for="tanggal-7">Tanggal Pembayaran 7</label>
                    <input type="date" id="tanggal-7" name="tanggal-bayar-7">
                    
                    <label for="bayar-7">Pembayaran 7 </label> <!-- Currency Field -->
                    <input type="number" id="bayar-7" name="bayar-7" placeholder="(Dalam Ribuan)" step="any" min="0">
                </div>
            </div>
            
            <!-- Add the hidden input field here to store the username -->
            <input type="hidden" id="username-field" name="username" value="">
            <input type="hidden" id="row-id" name="rowId">

            <div class="button-group">
            <input type="submit" value="Kirim Data" id="submit-button">
            <div id="loading-indicator" style="display: none;">sabar kak loading...</div>
            <button type="reset" id="reset-form-btn" class="reset-btn-custom">Reset Form</button>
            </div>
        </form>
    </div>

    <script src="scripts.js"></script>

</body>
</html>
